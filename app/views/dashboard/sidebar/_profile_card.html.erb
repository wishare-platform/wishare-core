<!-- Enhanced User Profile Card -->
<div class="bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-xl shadow-sm border border-rose-100 dark:border-gray-700 p-6"
     data-dashboard-delight-target="profileCard">
  <div class="flex flex-col items-center">
    <!-- User Avatar -->
    <div class="mb-4" data-dashboard-delight-target="profileAvatar">
      <%= user_avatar_or_initials(@user, size: 'w-24 h-24') %>
    </div>

    <!-- User Info -->
    <div class="text-center mb-4">
      <h2 class="heading-card text-gray-800 dark:text-gray-100 mb-1">
        <%= @user.name %>
      </h2>
      <p class="text-body-sm text-gray-600 dark:text-gray-400 mb-2">
        <%= @user.email %>
      </p>
      <p class="text-body-sm text-gray-500 dark:text-gray-400">
        <svg class="w-3 h-3 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 002 2z"></path>
        </svg>
        <%= t('dashboard.sidebar.profile.member_since') %> <%= @user.created_at.strftime("%B %Y") %>
      </p>
    </div>

    <!-- Bio Section (if present) -->
    <% if @user.respond_to?(:bio) && @user.bio.present? %>
      <div class="w-full mb-4 text-center">
        <p class="text-body-sm text-gray-600 dark:text-gray-400 leading-relaxed">
          <%= truncate(@user.bio, length: 100, omission: "...") %>
        </p>
      </div>
    <% end %>

    <!-- Quick Stats -->
    <div class="w-full border-t border-rose-100 dark:border-gray-700 pt-4">
      <div class="grid grid-cols-3 gap-4 text-center">
        <div class="cursor-pointer transition-transform hover:scale-105"
             data-dashboard-delight-target="statsCard"
             data-stat-type="wishlists"
             data-action="click->dashboard-delight#onStatsClick">
          <div class="text-lg font-bold text-rose-600 dark:text-rose-400">
            <%= @user.wishlists.count %>
          </div>
          <div class="text-body-sm text-gray-600 dark:text-gray-400"><%= t('dashboard.sidebar.stats.wishlists') %></div>
        </div>
        <div class="cursor-pointer transition-transform hover:scale-105"
             data-dashboard-delight-target="statsCard"
             data-stat-type="items"
             data-action="click->dashboard-delight#onStatsClick">
          <div class="text-lg font-bold text-rose-600 dark:text-rose-400">
            <%= @user.wishlists.joins(:wishlist_items).count %>
          </div>
          <div class="text-body-sm text-gray-600 dark:text-gray-400"><%= t('dashboard.sidebar.stats.items') %></div>
        </div>
        <div class="cursor-pointer transition-transform hover:scale-105"
             data-dashboard-delight-target="statsCard"
             data-stat-type="friends"
             data-action="click->dashboard-delight#onStatsClick">
          <div class="text-lg font-bold text-rose-600 dark:text-rose-400">
            <%= (@connections.size + @inverse_connections.size) %>
          </div>
          <div class="text-body-sm text-gray-600 dark:text-gray-400"><%= t('dashboard.sidebar.stats.friends') %></div>
        </div>
      </div>
    </div>

    <!-- Profile Completion Progress -->
    <% if @user.respond_to?(:profile_completion_percentage) %>
      <div class="w-full mt-4 pt-4 border-t border-rose-100 dark:border-gray-700">
        <div class="flex items-center justify-between mb-2">
          <span class="text-body-sm text-gray-600 dark:text-gray-400"><%= t('dashboard.sidebar.profile.profile_completion') %></span>
          <span class="text-body-sm font-medium text-gray-900 dark:text-gray-100">
            <%= @user.profile_completion_percentage %>%
          </span>
        </div>
        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
          <div class="bg-gradient-to-r from-rose-500 to-pink-500 h-2 rounded-full transition-all duration-300"
               style="width: <%= @user.profile_completion_percentage %>%"
               data-dashboard-delight-target="progressRing"></div>
        </div>
      </div>
    <% end %>
  </div>
</div>